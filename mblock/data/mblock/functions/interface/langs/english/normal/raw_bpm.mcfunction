tag @s add _bpm_player
execute as @e[tag=music_player,sort=nearest,limit=1] if entity @s[tag=direct_bpm] run tag @e[tag=_bpm_player] add enabled_dbpm
execute as @e[tag=music_player,sort=nearest,limit=1] if entity @s[tag=disable_double] run tag @e[tag=_bpm_player] add enabled_dd
execute as @e[tag=music_player,sort=nearest,limit=1] if entity @s[tag=compress_bpm] run tag @e[tag=_bpm_player] add compress_bpm
execute as @e[tag=music_player,sort=nearest,limit=1] if entity @s[tag=nbs_bpm] run tag @e[tag=_bpm_player] add nbs_bpm

execute if entity @e[tag=music_player,sort=nearest,limit=1] run tellraw @s[tag=!enabled_dbpm,tag=debug] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/use_raw_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "◆", "color": "red", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/use_raw_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/use_raw_bpm"}}, {"text": " "}, {"text": "Use Raw BPM", "color": "gray", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/use_raw_bpm"}, "hoverEvent": {"action": "show_text", "value": "Uses the BPM value directly.\n\n§5Scale by Accuracy:\n§9Low: §6100\n§9Medium: §61.000\n§9Normal: §610.000\n§9High: §6100.000"}}]
tellraw @s[tag=enabled_dbpm] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_use_raw_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "◆", "color": "green", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_use_raw_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_use_raw_bpm"}}, {"text": " "}, {"text": "Use Raw BPM", "color": "gray", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_use_raw_bpm"}, "hoverEvent": {"action": "show_text", "value": "Uses the BPM value directly.\n\n§5Scale by Accuracy:\n§9Low: §6100\n§9Medium: §61.000\n§9Normal: §610.000\n§9High: §6100.000"}}]

tellraw @s[tag=enabled_dbpm,tag=!enabled_dd] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/disable_double_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "◆", "color": "green", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/disable_double_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/disable_double_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": " "}, {"text": "Scale BPM", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/disable_double_bpm"}, "color": "gray", "hoverEvent": {"action": "show_text", "value": "§6Scales the BPM based on Accuracy."}}]
tellraw @s[tag=enabled_dbpm,tag=enabled_dd] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/double_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "◆", "color": "red", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/double_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/double_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": " "}, {"text": "Scale BPM", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/double_bpm"}, "color": "gray", "hoverEvent": {"action": "show_text", "value": "§6Scales the BPM based on Accuracy."}}]

execute if entity @e[tag=music_player,sort=nearest,limit=1] run tellraw @s[tag=!enabled_dbpm,tag=!compress_bpm] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/compress_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "◆", "color": "red", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/compress_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/compress_bpm"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": " "}, {"text": "Compress BPM", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/compress_bpm"}, "color": "gray", "hoverEvent": {"action": "show_text", "value": "Assume a space \nconsists of 3 song ticks.\n\n§9Useful for metronomes."}}]
tellraw @s[tag=!enabled_dbpm,tag=compress_bpm] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_compress_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "◆", "color": "green", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_compress_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_compress_bpm"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": " "}, {"text": "Compress BPM", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/not_compress_bpm"}, "color": "gray", "hoverEvent": {"action": "show_text", "value": "Assume a space \nconsists of 3 song ticks.\n\n§9Useful for metronomes."}}]
tellraw @s[tag=enabled_dbpm] ["", {"text": "[","hoverEvent": {"action": "show_text","value": "Incompatible with Raw BPM."}}, {"text": "◆", "color": "dark_gray","hoverEvent": {"action": "show_text","value": "Incompatible with Raw BPM."}}, {"text": "]","hoverEvent": {"action": "show_text","value": "Incompatible with Raw BPM."}}, {"text": " "}, {"text": "Compress BPM", "color": "gray", "hoverEvent": {"action": "show_text", "value": "Assume a space \nconsists of 3 song ticks.\n\n§9Useful for metronomes."}}]

execute if entity @e[tag=music_player,sort=nearest,limit=1] run tellraw @s[tag=!enabled_dbpm,tag=!nbs_bpm] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_on"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "◆", "color": "red", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_on"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_on"}, "hoverEvent": {"action": "show_text","value": "§eOff → §9On"}}, {"text": " "}, {"text": "Noteblock Studio BPM", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_on"}, "color": "gray", "hoverEvent": {"action": "show_text", "value": "It approximates the BPM of Noteblock Studio.\n\n§9Converting TPS to BPM:\n§6BPM = §a(TPS * 20)\n§65 BPM = §a(0.25tps * 20)"}}]
tellraw @s[tag=!enabled_dbpm,tag=nbs_bpm] ["", {"text": "[", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_off"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "◆", "color": "green", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_off"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": "]", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_off"}, "hoverEvent": {"action": "show_text","value": "§9On → §eOff"}}, {"text": " "}, {"text": "Noteblock Studio BPM", "clickEvent": {"action": "run_command","value": "/function mblock:interface/commands/nbs_bpm_off"}, "color": "gray", "hoverEvent": {"action": "show_text", "value": "It approximates the BPM of Noteblock Studio.\n\n§9Converting TPS to BPM:\n§6BPM = §a(TPS * 20)\n§65 BPM = §a(0.25tps * 20)"}}]
tellraw @s[tag=enabled_dbpm] ["", {"text": "[","hoverEvent": {"action": "show_text","value": "Incompatible with Raw BPM."}}, {"text": "◆", "color": "dark_gray","hoverEvent": {"action": "show_text","value": "Incompatible with Raw BPM."}}, {"text": "]","hoverEvent": {"action": "show_text","value": "Incompatible with Raw BPM."}}, {"text": " "}, {"text": "Noteblock Studio BPM", "color": "gray", "hoverEvent": {"action": "show_text", "value": "It approximates the BPM of Noteblock Studio.\n\n§9Converting TPS to BPM:\n§6BPM = §a(TPS * 20)\n§65 BPM = §a(0.25tps * 20)"}}]

tag @s remove _bpm_player
tag @s remove enabled_dbpm
tag @s remove enabled_dd
tag @s remove compress_bpm
tag @s remove nbs_bpm